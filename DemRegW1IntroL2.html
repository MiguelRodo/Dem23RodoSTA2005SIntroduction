<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Miguel Rodo">

<title>Introductory example of linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="DemRegW1IntroL2_files/libs/clipboard/clipboard.min.js"></script>
<script src="DemRegW1IntroL2_files/libs/quarto-html/quarto.js"></script>
<script src="DemRegW1IntroL2_files/libs/quarto-html/popper.min.js"></script>
<script src="DemRegW1IntroL2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="DemRegW1IntroL2_files/libs/quarto-html/anchor.min.js"></script>
<link href="DemRegW1IntroL2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="DemRegW1IntroL2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="DemRegW1IntroL2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="DemRegW1IntroL2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="DemRegW1IntroL2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introductory example of linear regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Miguel Rodo </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="problem-statement" class="level2">
<h2 class="anchored" data-anchor-id="problem-statement">Problem statement</h2>
<p>Suppose that you’re a business analyst tasked with helping the executives decide how to advertise.</p>
<p>You’ve gathered annual data across 200 markets in terms of sales revenue and advertising spend on TV, radio and newspaper. Your boss has heard about “regression”, and wants to see if it can be more informative than simply understanding that more advertising leads to more sales.</p>
</section>
<section id="set-up" class="level2">
<h2 class="anchored" data-anchor-id="set-up">Set-up</h2>
<p>First we attach R packages we need, which make useful functions available:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Indicating code in an Rmd/qmd
</summary>
<ul>
<li>How do I indicate code in an <code>Rmd</code>?
<ul>
<li>By “fencing” it</li>
<li>What does that mean?
<ul>
<li>Putting <code>{r} before the code and</code> after the code</li>
</ul></li>
<li>What is another name for the tick things?
<ul>
<li>Back ticks</li>
<li>Where is it on the keyboard?
<ul>
<li>Top left (next to one)</li>
</ul></li>
</ul></li>
<li>What do I put in between the fences?
<ul>
<li>Code!</li>
</ul></li>
</ul></li>
</ul>
</details>
<details>
<summary>
Attaching packages
</summary>
<p>In <code>R</code>, a package is a collection of functions that extend the functionality of <code>R</code>. In <code>R</code>, a library is a actually a folder where packages are installed (e.g.&nbsp;the output from <code>.libPaths()</code>).</p>
<p>Somewhat confusingly, the <code>library</code> function is used to attach a package into the current <code>R</code> session. For example, the package <code>tibble</code> provides the <code>as_tibble</code> function. If I run <code>as_tibble</code> without attaching the <code>tibble</code> package, I get the error that <code>as_tibble</code> function is not found. But if I first run <code>library(tibble)</code> and then run <code>as_tibble</code>, it works. Another option would be to not run <code>library(tibble)</code>, but instead directly reference the <code>tibble</code> package when using the <code>as_tibble</code> function, like so: <code>tibble::as_tibble</code> (note the double semi-colons).</p>
<p>Some languages do not allow you to attach libraries in the way <code>R</code> does. I prefer not attaching packages, but typical practice in the R community is to attach them. Since this is an introductory course, I’ll attach them.</p>
<p>If you are attaching them, then it’s good practice to attach them at the top of the script.</p>
</details>
<details>
<summary>
Naming datasets
</summary>
<ul>
<li>I like reading in naming data sets I’ve just read in <code>data_raw_&lt;name&gt;</code>
<ul>
<li>Converting it to a <code>tibble</code> prevents too much information being printed to the console each time you print it</li>
</ul></li>
</ul>
</details>
<p>First we read our data in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the raw data from the Advertising.csv file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_raw_ad <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"_data_raw/Advertising.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the raw data to a tibble for easier manipulation</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data_raw_ad <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(data_raw_ad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data exploration</h2>
<p>In the real world, it’s important to examine the data first as the analytical techniques chosen will depend on the data itself.</p>
<ul>
<li>Since we’re interested in performing linear regression, we would like to assess upfront the following:
<ul>
<li>Distribution of the response variable (hopefully normal)</li>
<li>Relationship between repsonse and dependent variables (hopefully linear)</li>
<li>Correlation between explanatory variables (hopefully absent)</li>
</ul></li>
<li>Once we’ve fitted the model, we can also be more sure that we haven’t made a mistake somewhere by the results matching what we see in preliminary data exploration.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first 10 rows of the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_raw_ad</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 × 5
       X    TV radio newspaper sales
   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1     1 230.   37.8      69.2  22.1
 2     2  44.5  39.3      45.1  10.4
 3     3  17.2  45.9      69.3   9.3
 4     4 152.   41.3      58.5  18.5
 5     5 181.   10.8      58.4  12.9
 6     6   8.7  48.9      75     7.2
 7     7  57.5  32.8      23.5  11.8
 8     8 120.   19.6      11.6  13.2
 9     9   8.6   2.1       1     4.8
10    10 200.    2.6      21.2  10.6
# ℹ 190 more rows</code></pre>
</div>
</div>
<p>We’ll consider a linear regression analysis.</p>
<p>We see that one column, <code>X</code>, is just the row number. So we delete it, yielding our analysis-ready dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_tidy_ad <span class="ot">&lt;-</span> data_raw_ad <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data_tidy_ad[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
     TV radio newspaper sales
  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1  230.  37.8      69.2  22.1</code></pre>
</div>
</div>
<details>
<summary>
Pipe operator
</summary>
<ul>
<li>The pipe operator, <code>|&gt;</code>, simplifies writing long chains of functions.
<ul>
<li>For example, <code>f(g(h(x))</code> is equivalent to <code>f() |&gt; g() |&gt; h()x</code>.</li>
<li>This might seem particularly advantageous here, but when <code>f</code>, <code>g</code> and <code>h</code> all have multiple arguments, having them on different lines is very helpful.</li>
</ul></li>
</ul>
</details>
<details>
<summary>
The tidyverse
</summary>
<ul>
<li>The two packages I’ve used so far, <code>tibble</code> and <code>dplyr</code>, are part of the <code>tidyverse</code>.
<ul>
<li>The <code>tidyverse</code> is a collection of packages that share a common philosophy of data manipulation.</li>
<li>The <code>tidyverse</code> is very popular in the <code>R</code> community, and is a good place to start.</li>
<li>The book <code>R for Data Science</code> is a good introduction to the <code>tidyverse</code>.</li>
</ul></li>
</ul>
</details>
<section id="distribution-of-response-variable" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-response-variable">Distribution of response variable</h3>
<p>First we’ll examine the distribution of the sales response variable, which will be our dependent variable, to assess whether a normal distribution might be appropriate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_tidy_ad<span class="sc">$</span>sales, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DemRegW1IntroL2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histDist</span>(data_tidy_ad<span class="sc">$</span>sales, <span class="at">family =</span> NO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DemRegW1IntroL2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family:  c("NO", "Normal") 
Fitting method: "nlminb" 

Call:  gamlssML(formula = data_tidy_ad$sales, family = "NO") 

Mu Coefficients:
[1]  14.02
Sigma Coefficients:
[1]  1.65

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   198 
Global Deviance:     1227.38 
            AIC:     1231.38 
            SBC:     1237.97 </code></pre>
</div>
</div>
<p>It seems approximately normally distributed, if positively skewed.</p>
<p>It’s important to note that the model only requires that the response variable be <em>conditionally</em> normally distributed, which we can’t assess until we’ve fit the model. But what we see thus far seems encouraging.</p>
</section>
<section id="correlation-between-explanatory-variables" class="level3">
<h3 class="anchored" data-anchor-id="correlation-between-explanatory-variables">Correlation between explanatory variables</h3>
<p>The effects of explanatory variables are hard to isolate when they are highly correlated with one another. So we’ll examine their correlation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data_tidy_ad <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(radio<span class="sc">:</span>sales)) <span class="sc">|&gt;</span> <span class="fu">signif</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          radio newspaper sales
radio      1.00      0.35  0.58
newspaper  0.35      1.00  0.23
sales      0.58      0.23  1.00</code></pre>
</div>
</div>
<p>They are all very low.</p>
<p>Graphs could highlight non-linear relationships not captured by the correlation statistics, as well as indicate outlying observations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_tidy_ad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DemRegW1IntroL2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The explanatory variables also look uncorrelated. A few possible outliers, but nothing dramatic.</p>
<p>Sales definitely seems to depend on TV and radio spending, but less so on newspaper spending.</p>
<p>So, overall, we’re happy that we’ll be able fit a linear model.</p>
</section>
</section>
<section id="modelling-sales-against-tv" class="level2">
<h2 class="anchored" data-anchor-id="modelling-sales-against-tv">Modelling sales against TV</h2>
<p>So, let’s just model sales against TV spending first.</p>
<p>In this case, we assume that <span class="math inline">\(Y_i=\beta_0 + \beta_{\mathrm{TV}}X_{i,\mathrm{TV}}+\epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\sim N(0,\sigma^2)\)</span>.</p>
<section id="fitting-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h3>
<p>We fit the model using the <code>lm</code> function, which finds values for <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_{\mathrm{TV}}\)</span> and <span class="math inline">\(\sigma^2\)</span> that best fit the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit_tv <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV, <span class="at">data =</span> data_tidy_ad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Simply printing the model output displays the model structure and the estimated regression coefficients (<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_{\mathrm{TV}}\)</span>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit_tv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV, data = data_tidy_ad)

Coefficients:
(Intercept)           TV  
    7.03259      0.04754  </code></pre>
</div>
</div>
</section>
<section id="examining-the-model-output" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-model-output">Examining the model output</h3>
<p>However, if we want to find out what the effect of TV on sales is (the estimate), how accurate that estimate is (the estimate’s standard error) and how compatible the data are with no effect (the p-value), we’ll need to use the <code>summary</code> function on the fitted model object to generate extra statistics and estimates:</p>
<section id="estimates" class="level4">
<h4 class="anchored" data-anchor-id="estimates">Estimates</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_tv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV, data = data_tidy_ad)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.3860 -1.9545 -0.1913  2.0671  7.2124 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 7.032594   0.457843   15.36   &lt;2e-16 ***
TV          0.047537   0.002691   17.67   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.259 on 198 degrees of freedom
Multiple R-squared:  0.6119,    Adjusted R-squared:  0.6099 
F-statistic: 312.1 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>As we can see, each one unit increase in TV spending increases sales by 0.047. - The 95% confidence interval for this effect is roughly (0.042, 0.052), which is probably precise enough, given the purpose. - The p-value is minute.</p>
<p>The plot below displays some of the key quantities associated with the data and the model:</p>
<p><img src="_data_raw/reg_img_exp.png" class="img-fluid"></p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: mean sales when TV spending is zero</li>
<li><span class="math inline">\(\beta_1\)</span>: The per-unit increase in mean sales for each unit increase in TV spending</li>
<li><span class="math inline">\(y_i\)</span>: The response value for the <span class="math inline">\(i\)</span>-th observation</li>
<li><span class="math inline">\(\hat{y}_i\)</span>: The fitted value for the <span class="math inline">\(i\)</span>-th observation</li>
<li><span class="math inline">\(\epsilon_i\)</span>: The residual for the <span class="math inline">\(i\)</span>-th observation (different between actual and fitted response value, i.e.&nbsp;<span class="math inline">\(y_i-\hat{y}_i\)</span>)</li>
</ul>
</section>
<section id="fitted-values-and-residuals" class="level4">
<h4 class="anchored" data-anchor-id="fitted-values-and-residuals">Fitted values and residuals</h4>
<p>By virtue of fitting the model, we’ve described a way for relating any value of TV spending to average sales.</p>
<p>For example, if someone spends 100 on TV advertising, we can predict that their average sales will be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>coef_vec <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(fit_tv) <span class="sc">|&gt;</span> <span class="fu">setNames</span>(<span class="cn">NULL</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> coef_vec[<span class="dv">1</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> coef_vec[<span class="dv">2</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.8</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="modelling-sales-against-tv-radio-and-newspaper" class="level2">
<h2 class="anchored" data-anchor-id="modelling-sales-against-tv-radio-and-newspaper">Modelling sales against TV, radio and newspaper</h2>
<p>Now that we’ve examined sales against TV, let’s examine sales against all three explanatory variables.</p>
<p>In this case, we assume that <span class="math inline">\(Y_i=\beta_0 + \beta_{\mathrm{TV}}X_{i,\mathrm{TV}} + \beta_{\mathrm{R}}X_{i,\mathrm{R}} + \beta_{\mathrm{N}}X_{i,\mathrm{N}} +\epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\sim N(0,\sigma^2)\)</span>.</p>
<section id="fitting-the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model-1">Fitting the model</h3>
<p>We fit the model using the <code>lm</code> function as before, which finds optimal values for the unknowne parameters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fit_all <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper, <span class="at">data =</span> data_tidy_ad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="examining-the-model-output-1" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-model-output-1">Examining the model output</h3>
<p>Let’s examine the detailed inferential output from the <code>summary</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ TV + radio + newspaper, data = data_tidy_ad)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.8277 -0.8908  0.2418  1.1893  2.8292 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.938889   0.311908   9.422   &lt;2e-16 ***
TV           0.045765   0.001395  32.809   &lt;2e-16 ***
radio        0.188530   0.008611  21.893   &lt;2e-16 ***
newspaper   -0.001037   0.005871  -0.177     0.86    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.686 on 196 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8956 
F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Radio spending clearly associated with sales, and newspaper spending not.</li>
<li>There has been little change in the inference regarding the effect of TV advertising spend on sales.
<ul>
<li>The only (subtle) change is that we now can confirm (in addition to the data exploration) that the effect of TV is not driven by an association between TV and radio.</li>
</ul></li>
</ul>
</section>
</section>
<section id="connection-to-future-lessons" class="level2">
<h2 class="anchored" data-anchor-id="connection-to-future-lessons">Connection to future lessons</h2>
<ul>
<li>Over the next few weeks, we will develop the mathematical and statistical theory to estimate the parameters and conduct inference regarding them.</li>
<li>Once we’ve done that, we’ll actually have a flexible inferential tool we can make use of.</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>